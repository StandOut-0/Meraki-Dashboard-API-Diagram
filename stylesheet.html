<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ì‹œíŠ¸ ìë™ ë¡œë”© (íŒŒë¼ë¯¸í„° ê¸°ë°˜)</title>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  </head>
<body>

  <!--  ìƒì„¸í˜ì´ì§€ - API í”„ë¡ íŠ¸ ì‘ì—…ì„ ìœ„í•œ ì˜ˆì‹œ url
  http://127.0.0.1:5500/stylesheet.html?sheet=admin
  -->
  
  <main>
    <div class="px-4 py-5 my-5 text-center"> 
      <img class="d-block mx-auto mb-4" src="https://www.airquay.com/data/home/20250620110625.png" alt=""> 
      <h1 class="display-5 fw-bold text-body-emphasis">lorem</h1> 
      <div class="col-lg-6 mx-auto"> 
        <p class="lead mb-4">lorem</p>
         
        <div class="input-group justify-content-sm-center">
          <input type="text" id="searchBox" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" class="form-control">
          <button type="button" id="searchBtn" class="btn btn-primary btn-lg">lorem</button>
        </div> 
      </div> 
    </div>

    <div>
      <div class="accordion" id="accordionPanelsStayOpenExample">
      </div>
    </div>

  </main>

  
  <p id="sheet-title" class="text-end">ì‹œíŠ¸ ë‚´ìš© ë³´ê¸°</p>
  <div id="sheet-content">ë¡œë”© ì¤‘...</div>


   <div class="mt-5 p-5 bg-light">
      <h2>text</h2>

      <p class="text-start">Start aligned text on all viewport sizes.</p>
      <p class="text-center">Center aligned text on all viewport sizes.</p>
      <p class="text-end">End aligned text on all viewport sizes.</p>

      <p class="text-lowercase">Lowercased text.</p>
      <p class="text-uppercase">Uppercased text.</p>
      <p class="text-capitalize">CapiTaliZed text.</p>

      <p class="fs-1">.fs-1 text</p>
      <p class="fs-2">.fs-2 text</p>
      <p class="fs-3">.fs-3 text</p>
      <p class="fs-4">.fs-4 text</p>
      <p class="fs-5">.fs-5 text</p>

      <p class="fw-normal">Normal weight text.</p>
      <p class="fst-italic">Italic text.</p>
      Secondary body text with a <a href="#" class="text-reset">reset link</a>.

      <p class="lh-base">This is a long paragraph written to show how the line-height of an element is affected by our utilities. Classes are applied to the element itself or sometimes the parent element. These classes can be customized as needed with our utility API.</p>
      
    </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  
<script>
    function searchAccordion() {
        const value = document.getElementById("searchBox").value.toLowerCase();
        const targets = document.querySelectorAll("button[class^='accordion-button']");
        for (let t of targets) {
            if (t.textContent.toLowerCase().includes(value)) {
                t.scrollIntoView({ behavior: "smooth" });
                t.focus();
                break;
            }
        }
    }

    document.getElementById("searchBox").addEventListener("keyup", function(e) {
        if (e.key === "Enter") {
            searchAccordion();
        }
    });

    document.getElementById("searchBtn").addEventListener("click", function() {
        searchAccordion();
    });
</script>


<script>
  const params = new URLSearchParams(window.location.search);
  const sheetName = params.get('sheet');

  if (!sheetName) {
    document.getElementById('sheet-content').textContent = "â— URLì— ?sheet=ì‹œíŠ¸ì´ë¦„ íŒŒë¼ë¯¸í„°ê°€ í•„ìš”í•©ë‹ˆë‹¤.";
  } else {
    document.getElementById('sheet-title').textContent = `ì‹œíŠ¸ì´ë¦„: ${sheetName}`;

    fetch('meraki-api-index-sorted.xlsx') 
      .then(res => res.arrayBuffer())
      .then(buffer => {
        const workbook = XLSX.read(buffer, { type: 'array' });

        if (!workbook.SheetNames.includes(sheetName)) {
          document.getElementById('sheet-content').textContent = `â— ì‹œíŠ¸ "${sheetName}"ì„(ë¥¼) ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`;
          return;
        }

        const sheet = workbook.Sheets[sheetName];
        const data = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        // í—¤ë”(ì²« í–‰)ì™€ ì‹¤ì œ ë°ì´í„° ë¶„ë¦¬
        const headers = data[0];
        const rows = data.slice(1);

        // ì•„ì½”ë””ì–¸ ì»¨í…Œì´ë„ˆ ìƒì„±
        const accordion = document.createElement('div');
        accordion.className = "accordion";
        accordion.id = "apiAccordion";

        rows.forEach((row, index) => {
          if (!row || row.length === 0) return; // ë¹ˆ í–‰ skip

          // ì£¼ìš” ì—´ ê°’ë“¤ ì¶”ì¶œ - start
          const releaseStage = row[headers.indexOf("releaseStage")] || "";
          const method = row[headers.indexOf("method")] || "";
          const path   = row[headers.indexOf("path")] || "";
          const apiDocsUrl     = row[headers.indexOf("apiDocsUrl")] || "";
          // ì£¼ìš” ì—´ ê°’ë“¤ ì¶”ì¶œ - end
          
          const item = document.createElement("div");
          item.className = "accordion-item";





          // accordion-header
          const headerId = `heading${index}`;
          const collapseId = `collapse${index}`;
          const h2 = document.createElement("h2");
          h2.className = "accordion-header";
          h2.id = headerId;

          const button = document.createElement("button");
          button.className = "accordion-button collapsed";
          button.type = "button";
          button.setAttribute("data-bs-toggle", "collapse");
          button.setAttribute("data-bs-target", `#${collapseId}`);
          button.setAttribute("aria-expanded", "false");
          button.setAttribute("aria-controls", collapseId);


          // releaseStage badge í´ë˜ìŠ¤ ê²°ì •
          let stageClass = "text-bg-primary";
          if (releaseStage.toLowerCase() === "ga") stageClass = "text-bg-success";
          else if (releaseStage.toLowerCase() === "beta") stageClass = "text-bg-warning";
          else if (releaseStage.toLowerCase() === "deprecated") stageClass = "text-bg-danger";


          // method ìƒ‰ìƒ í´ë˜ìŠ¤ ê²°ì •
          let methodColor = "";
          switch (method.toLowerCase()) {
            case "post": methodColor = "text-warning"; break;   // ì˜¤ë Œì§€
            case "put": methodColor = "text-primary"; break;    // íŒŒë‘
            case "delete": methodColor = "text-danger"; break;  // ë¹¨ê°•
            case "get": methodColor = "text-success"; break;    // ì´ˆë¡
            default: methodColor = "text-secondary";
          }

          // releaseStage
          const badge = document.createElement("span");
          badge.className = `badge rounded-pill ${stageClass} me-2 text-uppercase`;
          badge.textContent = releaseStage;

          // method
          const methodSpan = document.createElement("span");
          methodSpan.className = `${methodColor} me-2 text-uppercase`;
          methodSpan.textContent = method;

          // apiDocsUrl
          const link = document.createElement("a");
          link.href = apiDocsUrl;
          link.target = "_blank";
          link.className = "ms-2 text-reset text-decoration-none";
          link.title = "API Docs";
          link.innerHTML = 'ğŸ”—';
          link.style.pointerEvents = "auto";
          link.tabIndex = -1;
          link.addEventListener("click", function(e) {
            e.stopPropagation();
            e.preventDefault();
            window.open(apiDocsUrl, '_blank');
          });

          // ê¸°ì¡´ í…ìŠ¤íŠ¸ ì œê±° í›„ ìš”ì†Œ ì¡°ë¦½
          button.textContent = "";
          button.appendChild(badge);
          button.appendChild(methodSpan);
          button.append(document.createTextNode(path));
          button.appendChild(link);

          h2.appendChild(button);


          // accordion-body
          const collapseDiv = document.createElement("div");
          collapseDiv.id = collapseId;
          collapseDiv.className = "accordion-collapse collapse";
          collapseDiv.setAttribute("aria-labelledby", headerId);
          collapseDiv.setAttribute("data-bs-parent", "#apiAccordion");

          const body = document.createElement("div");
          body.className = "accordion-body";

          // ë‚˜ë¨¸ì§€ ì—´ ê°’ë“¤ í…Œì´ë¸”ë¡œ ë„£ê¸°
          const table = document.createElement("table");
          table.className = "table table-sm";
          const tbody = document.createElement("tbody");

          headers.forEach((colName, colIndex) => {
            if (colName.toLowerCase() === "method" || colName.toLowerCase() === "path") return;
            const tr = document.createElement("tr");
            const tdKey = document.createElement("td");
            tdKey.textContent = colName;
            tdKey.className = "fw-bold pe-3";
            const tdVal = document.createElement("td");
            tdVal.textContent = row[colIndex] !== undefined ? row[colIndex] : "-";
            tr.appendChild(tdKey);
            tr.appendChild(tdVal);
            tbody.appendChild(tr);
          });

          table.appendChild(tbody);
          body.appendChild(table);
          collapseDiv.appendChild(body);

          // ì•„ì´í…œ ì¡°ë¦½
          item.appendChild(h2);
          item.appendChild(collapseDiv);

          accordion.appendChild(item);
        });

        // ê¸°ì¡´ sheet-contentì— ì¶œë ¥
        const container = document.getElementById('sheet-content');
        container.innerHTML = '';
        container.appendChild(accordion);
      })
      .catch(err => {
        document.getElementById('sheet-content').textContent = `â— ì—‘ì…€ íŒŒì¼ ë¡œë“œ ì˜¤ë¥˜: ${err}`;
      });
  }
</script>

  
</body>
</html>
