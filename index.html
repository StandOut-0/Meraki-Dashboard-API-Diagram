<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>시트 자동 로딩 (파라미터 기반)</title>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
  <style>
    table {
      border-collapse: collapse;
      margin-top: 20px;
    }
    td, th {
      border: 1px solid #ccc;
      padding: 5px 10px;
    }
  </style>
</head>
<body>
  <h2 id="sheet-title">시트 내용 보기</h2>
  <div id="sheet-content">로딩 중...</div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const sheetName = params.get('sheet');

    if (!sheetName) {
      document.getElementById('sheet-content').textContent = "❗ URL에 ?sheet=시트이름 파라미터가 필요합니다.";
    } else {
      document.getElementById('sheet-title').textContent = `시트: ${sheetName}`;

      fetch('meraki-api-index.xlsx')
        .then(res => res.arrayBuffer())
        .then(buffer => {
          const workbook = XLSX.read(buffer, { type: 'array' });

          if (!workbook.SheetNames.includes(sheetName)) {
            document.getElementById('sheet-content').textContent = `❗ 시트 "${sheetName}"을(를) 찾을 수 없습니다.`;
            return;
          }

          const sheet = workbook.Sheets[sheetName];
          const data = XLSX.utils.sheet_to_json(sheet, { header: 1 });

          const table = document.createElement('table');
          data.forEach(row => {
            const tr = document.createElement('tr');
            row.forEach(cell => {
              const td = document.createElement('td');
              td.textContent = cell !== undefined ? cell : '';
              tr.appendChild(td);
            });
            table.appendChild(tr);
          });

          const container = document.getElementById('sheet-content');
          container.innerHTML = '';
          container.appendChild(table);
        })
        .catch(err => {
          document.getElementById('sheet-content').textContent = `❗ 엑셀 파일 로드 오류: ${err}`;
        });
    }
  </script>
</body>
</html>
